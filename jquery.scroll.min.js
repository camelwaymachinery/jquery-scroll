jQuery.fn.extend({scroll:function(){var direction;var waittime;var transitiontime;var callback;if(arguments.length==0){direction="left";waittime=3000;transitiontime=1000}else{if(arguments.length==1){direction=arguments[0];waittime=3000;transitiontime=1000}else{if(arguments.length==2){direction=arguments[0];waittime=arguments[1];transitiontime=1000}else{if(arguments.length==3){direction=arguments[0];waittime=arguments[1];transitiontime=arguments[2]}else{if(arguments.length==4){direction=arguments[0];waittime=arguments[1];transitiontime=arguments[2];callback=arguments[3]}}}}}if(typeof(direction)=="function"){callback=direction;direction="left"}if(typeof(waittime)=="function"){callback=waittime;waittime=3000}if(typeof(transitiontime)=="function"){callback=transitiontime;transitiontime=1000}var $childnotes=$(this).children();var childrenwidth=$childnotes.width();var childrenheight=$childnotes.height();var childcount=$childnotes.length+2;var initmarginleft=-childrenwidth;$childnotes.css({"display":"block","float":"left","width":childrenwidth+"px"});var $wrap=$(this).children().wrapAll("<div></div>").parent();var $lastchild=$childnotes.last().clone();var $firstchild=$childnotes.first().clone();$wrap.css({"position":"relative","float":"left","width":childrenwidth*childcount,"margin-left":initmarginleft+"px"});$wrap.append($firstchild).prepend($lastchild);var marginleftstep=childrenwidth;var maxmarginleft=-childrenwidth*(childcount-1);var maxmarginright=0;var index=0;function transform(){if(arguments.length<1){console.erro("transfrom except at least two one arguments but there is no arguments!")}else{if(arguments.length==1){var distance=arguments[0];var time=transitiontime;var callback=null}else{if(arguments.length==2){var distance=arguments[0];var argu2=arguments[1];if(typeof(argu2)=="function"){var time=transitiontime;var callback=argu2}else{var time=argu2;var callback=null}}else{var distance=arguments[0];var time=arguments[1];var callback=arguments[2]}}}var thismarginleft=parseFloat($wrap.css("margin-left"));if(distance<0&&thismarginleft<=maxmarginleft){thismarginleft=initmarginleft;$wrap.css("margin-left",thismarginleft)}else{if(distance>0&&thismarginleft>=maxmarginright){thismarginleft=-(childcount-2)*childrenwidth;$wrap.css("margin-left",thismarginleft)}}$wrap.animate({"margin-left":thismarginleft+distance+"px"},time,function(){var absmarginleft=Math.abs(parseFloat($wrap.css("margin-left")));var offsetcount=Math.floor(absmarginleft/childrenwidth)-1;index=(offsetcount+childcount-2)%(childcount-2);if(callback){callback(index)}})}function scrollright(){transform(childrenwidth,transitiontime,callback)}function scrollleft(){transform(-childrenwidth,transitiontime,callback)}function getindex(){return index}var interval;function run(){interval=setTimeout(function(){if(direction=="right"){scrollright()}else{if(direction=="left"){scrollleft()}}run()},waittime)}function pause(){clearInterval(interval)}function start(){run()}run();return new ScrollAction(direction,start,pause,transform,$wrap,$(this),getindex,callback)},imagezoom:function(){var windowwidth=$(window).width();var windowheight=$(window).height();$(this).find("img").each(function(){var width=$(this).width();var height=$(this).height();var naturalWidth=$(this).get(0).naturalWidth||0;var naturalHeight=$(this).get(0).naturalHeight||0;if(naturalWidth>width*1.2&&windowwidth>width*1.2){var posleft=$(this).offset().left;var postop=$(this).offset().top;$(this).css("cursor","zoom-in");$(this).bind("click",function(){var thisleft=posleft;var thistop=postop;var radio=naturalWidth/windowwidth>naturalHeight/windowheight?naturalWidth/windowwidth:naturalHeight/windowheight;radio=radio>1?radio:1;naturalWidth=naturalWidth/radio;naturalHeight=naturalHeight/radio;thisleft=(windowwidth-naturalWidth)/2;thistop=$(window).scrollTop()+(windowheight-naturalHeight)/2;$("<div class='ImageView' style='position:absolute;0;top:0;left:0;z-index:99998;width:100%;height:"+$(document).height()+"px;float:left;background:rgba(0,0,0,.3)'></div>").appendTo("body");$(this).clone().appendTo(".ImageView").css({"position":"absolute","z-index":"99999","left":posleft+"px","top":postop+"px","cursor":"zoom-out"}).animate({"width":naturalWidth,"height":naturalHeight,"left":thisleft,"top":thistop},300).parent().bind("click",function(){$(this).children("img").animate({"width":width,"height":height,"left":posleft+"px","top":postop+"px"},300,function(){$(this).parent().remove();$(this).remove()})})})}})}});function ScrollAction(direction,start,pause,transform,wrap,caller,getindexfunc,transformcallback){function getindex(){return getindexfunc()}function touchscroll(){var stepdistance=wrap.children().width();var startX,endX;wrap.bind("touchstart",function(e){pause();var _touch=e.originalEvent.targetTouches[0];startX=Math.ceil(_touch.pageX);endX=startX});wrap.bind("touchmove",function(e){var _touch=e.originalEvent.targetTouches[0];movesteps=Math.ceil(_touch.clientX)-endX;endX=Math.ceil(_touch.clientX);transform(movesteps,0)
});wrap.bind("touchend",function(e){var remaindistance;var marginleft=parseFloat(wrap.css("margin-left"));var movedistance=Math.abs(marginleft%stepdistance);if(endX>startX){remaindistance=movedistance}else{remaindistance=-(stepdistance-movedistance)}transform(remaindistance,300,transformcallback);start()})}function scroll($iconwrap,addclass){if($iconwrap.children().length+2!=wrap.children().length){console.error("the linked number as not same as animate number!")}$iconwrap.hover(function(){pause()},function(){start()});wrap.hover(function(){pause()},function(){start()});$iconwrap.children().bind("click",function(){pause();var clickindex=$(this).index();var currentindex=getindex();if(clickindex==currentindex){return}if(clickindex>currentindex){transform(-wrap.children().width()*(clickindex-currentindex),transformcallback)}else{if(clickindex<currentindex){transform(wrap.children().width()*(currentindex-clickindex),transformcallback)}}})}function mousescroll(){wrap.hover(function(){pause()},function(){start()});if(arguments.length>1){arguments[0].bind("click",function(){transfrom(wrap.children().width())});arguments[1].bind("click",function(){transfrom(-wrap.children().width())})}}function end(){return caller}return{"start":start,"pause":pause,"wrap":wrap,"touchscroll":touchscroll,"mousescroll":mousescroll,"getindex":getindex,"scroll":scroll,"end":end}};
